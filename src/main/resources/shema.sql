CREATE TABLE IF NOT EXISTS USERS
(
    ID            BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    NAME          varchar(100) NOT NULL,
    EMAIL         varchar(320),
    CONSTRAINT UQ_EMAIL UNIQUE (email)
    );

CREATE TABLE IF NOT EXISTS REQUEST
(
    ID            BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME          varchar(200),
    REQUESTOR_ID  BIGINT REFERENCES users (id) ON DELETE CASCADE,
    CREATION_DATE timestamp
    );

CREATE TABLE IF NOT EXISTS ITEMS
(
    ID            BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME          varchar(100) NOT NULL,
    DESCRIPTION   varchar(200),
    AVAILABLE     bool,
    OWNER_ID      BIGINT       NOT NULL REFERENCES users (id) ON DELETE CASCADE,
    REQUEST_ID    BIGINT REFERENCES item_request (id)
    );

CREATE TABLE IF NOT EXISTS BOOKINGS
(
    ID            BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    START_DATE    timestamp,
    END_DATE      timestamp,
    BOOKER_ID     BIGINT REFERENCES users (id) ON DELETE CASCADE,
    ITEM_ID       BIGINT REFERENCES items (id) ON DELETE CASCADE,
    STATUS        varchar(30)
    );

CREATE TABLE IF NOT EXISTS COMMENTS
(
    ID            BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    TEXT          varchar(300) NOT NULL,
    ITEM_ID       BIGINT REFERENCES items (id) ON DELETE CASCADE,
    AUTHOR_ID     BIGINT REFERENCES users (id) ON DELETE CASCADE,
    CREATED       timestamp
    );